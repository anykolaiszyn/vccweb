<!DOCTYPE html>
<html lang="en">
  <!-- _includes/head.html -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  
  <!-- Security Headers -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://formspree.io; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:; connect-src 'self' https://formspree.io; frame-ancestors 'none';">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta http-equiv="X-XSS-Protection" content="1; mode=block">
  <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
  
  <!-- SEO Meta Tags - Enhanced with jekyll-seo-tag -->
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>In-Stock Tobacco Products | Vice City Cigars</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="In-Stock Tobacco Products" />
<meta name="author" content="Vice City Cigars" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Browse our in-stock tobacco products and pre-order premium cigars, pipes, and tobacco from Vice City Cigars." />
<meta property="og:description" content="Browse our in-stock tobacco products and pre-order premium cigars, pipes, and tobacco from Vice City Cigars." />
<link rel="canonical" href="https://anykolaiszyn.github.io/vccweb/tobacco-shop/" />
<meta property="og:url" content="https://anykolaiszyn.github.io/vccweb/tobacco-shop/" />
<meta property="og:site_name" content="Vice City Cigars" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="In-Stock Tobacco Products" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@Vice City Cigars" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Vice City Cigars"},"description":"Browse our in-stock tobacco products and pre-order premium cigars, pipes, and tobacco from Vice City Cigars.","headline":"In-Stock Tobacco Products","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://anykolaiszyn.github.io/vccweb/assets/img/vcclogoclear.png"},"name":"Vice City Cigars"},"url":"https://anykolaiszyn.github.io/vccweb/tobacco-shop/"}</script>
<!-- End Jekyll SEO tag -->

  
  <!-- Favicon and Icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/vccweb/assets/img/vcclogoclear.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/vccweb/assets/img/vcclogoclear.png">
  
  <!-- Preload Critical Assets -->
  <link rel="preload" href="/vccweb/assets/img/vcclogoclear.png" as="image">
  <link rel="preload" href="/vccweb/assets/css/theme.css" as="style">
  
  <!-- Optimized Google Fonts Loading -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Exo+2:wght@300;400;600&family=Orbitron:wght@400;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Exo+2:wght@300;400;600&family=Orbitron:wght@400;700&display=swap" rel="stylesheet"></noscript>
  
  <!-- Stylesheets -->
  <link rel="stylesheet" href="/vccweb/assets/css/theme.css">
  <link rel="stylesheet" href="/vccweb/assets/css/style.css">
  
  <!-- Scripts -->
  <script src="/vccweb/assets/js/mobile-menu.js" defer></script>
  <script src="/vccweb/assets/js/contact-form.js" defer></script>
  
  <!-- No JavaScript Fallback -->
  <noscript><style>.age-gate-modal{display:block;}</style></noscript>
  
  <!-- Structured Data for Local Business -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "LocalBusiness",
    "name": "Vice City Cigars",
    "description": "Premium cigars, pipes, hookahs, and mobile event services in Boca Raton. Tropical, laid-back, and expert hospitality.",
    "url": "https://anykolaiszyn.github.io/vccweb",
    "telephone": "+1-561-331-0491",
    "email": "vccigar@gmail.com",
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Boca Raton",
      "addressRegion": "FL",
      "addressCountry": "US"
    },
    "image": "https://anykolaiszyn.github.io/vccweb/assets/img/vcclogoclear.png",
    "priceRange": "$$",
    "sameAs": [
      "https://instagram.com/vicecitycigars"
    ]
  }
  </script>
</head>

  <body>
    <div id="age-gate-modal" class="age-gate-modal" role="dialog" aria-modal="true" aria-labelledby="age-gate-title" tabindex="-1">
  <div class="age-gate-content">
    <h2 id="age-gate-title">Are you 21 or older?</h2>
  <p aria-live="polite">This site is for adults 21+ only. Please confirm your age to enter.</p>
    <div class="age-gate-actions">
      <button id="age-gate-yes" class="btn btn-primary">Yes, I am 21+</button>
      <button id="age-gate-no" class="btn btn-secondary">No</button>
    </div>
    <p class="age-gate-legal">We do not offer free samples.</p>
  </div>
</div>
<script src="/vccweb/assets/js/age-gate.js" defer></script>

    <a class="skip-link" href="#main-content">Skip to content</a>
<header class="site-header">
  <div class="container header-flex">
    <a href="/vccweb/" class="logo-link">
      <img src="/vccweb/assets/img/vcclogoclear.png" alt="Vice City Cigars logo" class="site-logo" width="140" height="auto">
    </a>
    
    <button class="mobile-menu-toggle" aria-label="Toggle navigation menu" aria-expanded="false">
      <span class="hamburger"></span>
      <span class="hamburger"></span>
      <span class="hamburger"></span>
    </button>
    
    <nav class="main-nav" aria-label="Main navigation">
      <ul>
        <li><a href="/vccweb/">Home</a></li>
        <li class="nav-dropdown">
          <a href="#shop">Shop â–¼</a>
          <ul class="nav-dropdown-menu">
            <li><a href="/vccweb/square-shop">Square Shop</a></li>
            <li><a href="/vccweb/tobacco-shop">Tobacco Products</a></li>
          </ul>
        </li>
        <li><a href="/vccweb/services">Services</a></li>
        <li><a href="/vccweb/events">Events</a></li>
        <li><a href="/vccweb/learn">Learn</a></li>
        <li><a href="/vccweb/blog">Blog</a></li>
        <li><a href="/vccweb/contact">Contact</a></li>
      </ul>
    </nav>
    
    <a href="/vccweb/contact" class="btn btn-primary header-book-btn">Book Your Event</a>
  </div>
</header>

    <main class="container" id="main-content" role="main" tabindex="-1">
      <article class="page-content">
  <div class="tobacco-shop-page">
  <div class="shop-subheader">
    <div class="container">
      <div class="shop-info">
        <h1 class="shop-title">In-Stock Tobacco Products</h1>
        <p class="shop-subtitle">Browse what's available now for pre-order and pickup</p>
      </div>
      <div class="cart-indicator">
        ðŸ›’ Cart: <span id="cartCount">0</span> items
      </div>
    </div>
  </div>

  <main id="main-content" class="container">
    <section id="instock-tobacco" class="card">
      <div class="section-header">
        <h2 class="section-title">In-Stock Tobacco Products</h2>
        <p class="section-subtitle">
          Browse what's currently available at our mobile events and in-person pickups.
          Pre-order your favorites and we'll have them ready for you!
        </p>
      </div>

      <div class="compliance-notice">
        <strong>ðŸ”ž 21+ Only</strong>
        <p>
          All orders are manually age-verified and invoiced.
          No credit card payments are processed on this website.
          We'll contact you to arrange payment and pickup/delivery.
        </p>
      </div>

      <div id="productContainer">
        <div class="loading-state">
          Loading available cigars & tobacco...
        </div>
      </div>
    </section>
  </main>
</div>

<script>
    // ===== Configuration =====
    const API_URL = 'https://script.google.com/macros/s/AKfycbxV-V5BHN2a97yb0fPYVjuofjJRUAFPnPu1d73kKwnxkqXTojYEFK3c0B1qAOzKO1Aquw/exec';
    
    // ===== Global State =====
    let cart = [];

    // ===== Helper Functions =====
    
    /**
     * Sanitize category string - take the last segment after '>'
     */
    function sanitizeCategory(rawCategories) {
      if (!rawCategories || rawCategories.trim() === '') return 'Uncategorized';
      const segments = rawCategories.split('>').map(s => s.trim());
      return segments[segments.length - 1] || 'Uncategorized';
    }

    /**
     * Strip HTML tags from description
     */
    function stripHtml(html) {
      if (!html) return '';
      const temp = document.createElement('div');
      temp.innerHTML = html;
      return temp.textContent || temp.innerText || '';
    }

    /**
     * Format price as currency
     */
    function formatPrice(price) {
      const num = Number(price);
      return isNaN(num) ? '$0.00' : `$${num.toFixed(2)}`;
    }

    /**
     * Update cart counter in header
     */
    function updateCartCounter() {
      const cartCount = document.getElementById('cartCount');
      if (cartCount) {
        cartCount.textContent = cart.length;
      }
    }

    /**
     * Add item to cart
     */
    function addToCart(sku, name, price) {
      const item = {
        sku: sku,
        name: name,
        price: price,
        timestamp: new Date().toISOString()
      };
      
      cart.push(item);
      updateCartCounter();
      
      console.log('Added to cart:', item);
      console.log('Current cart:', cart);
      
      // Show user feedback
      alert(`Added "${name}" to your pre-order cart!\n\nItems in cart: ${cart.length}`);
    }

    /**
     * Render product cards
     */
    function renderProducts(items) {
      const container = document.getElementById('productContainer');
      
      if (!items || items.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            No items are currently in stock. Please check back soon or contact Vice City Cigars.
          </div>
        `;
        return;
      }

      const grid = document.createElement('div');
      grid.className = 'product-grid';

      items.forEach(item => {
        const category = sanitizeCategory(item.Categories);
        const description = stripHtml(item.Description);
        const shortDescription = description.length > 150 
          ? description.substring(0, 150) + '...' 
          : description;
        const sku = item.SKU || 'N/A';
        const stock = item.Qty_On_Hand || 0;
        const price = formatPrice(item.Price);

        const card = document.createElement('div');
        card.className = 'product-card';
        card.innerHTML = `
          <div>
            <h3 class="product-name">${item.Display_Name || 'Unnamed Product'}</h3>
            <span class="product-category">${category}</span>
          </div>
          <p class="product-description">${shortDescription || 'No description available.'}</p>
          <div class="product-meta">
            <span class="product-stock">In stock: ${stock}</span>
            <span class="product-price">${price}</span>
          </div>
          <div class="product-sku">SKU: ${sku}</div>
          <button class="add-to-cart-btn" data-sku="${sku}" data-name="${item.Display_Name}" data-price="${item.Price}">
            Add to Pre-Order
          </button>
        `;

        grid.appendChild(card);
      });

      container.innerHTML = '';
      container.appendChild(grid);

      // Attach event listeners to all Add to Cart buttons
      const buttons = container.querySelectorAll('.add-to-cart-btn');
      buttons.forEach(button => {
        button.addEventListener('click', (e) => {
          const sku = e.target.dataset.sku;
          const name = e.target.dataset.name;
          const price = e.target.dataset.price;
          addToCart(sku, name, price);
        });
      });
    }

    /**
     * Fetch products from API
     */
    async function fetchProducts() {
      try {
        const response = await fetch(`${API_URL}?route=inventory`);
        
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data && data.items) {
          renderProducts(data.items);
        } else {
          throw new Error('Invalid API response format');
        }
      } catch (error) {
        console.error('Error fetching products:', error);
        
        const container = document.getElementById('productContainer');
        container.innerHTML = `
          <div class="empty-state">
            <p>Unable to load products at this time.</p>
            <p style="color: var(--vcc-text-muted); font-size: 0.9rem; margin-top: 1rem;">
              Error: ${error.message}
            </p>
            <p style="margin-top: 2rem;">
              Please contact Vice City Cigars directly at 
              <a href="tel:+15613310491" style="color: var(--vcc-gold);">561-331-0491</a>
            </p>
          </div>
        `;
      }
    }

    // ===== Initialize on Page Load =====
    document.addEventListener('DOMContentLoaded', () => {
      fetchProducts();
    });

    // ===== Expose cart to console for debugging =====
    window.getCart = () => {
      console.table(cart);
      return cart;
    };

    console.log('%cðŸ”¥ Vice City Cigars Tobacco Shop Loaded', 'color: #ffcc66; font-size: 16px; font-weight: bold;');
    console.log('%cTo view cart contents, type: getCart()', 'color: #00ffff;');
  </script>

</article>

    </main>
    <footer class="site-footer">
  <div class="container footer-flex">
    <div class="footer-brand">
      <img src="/vccweb/assets/img/vcclogoclear.png" alt="Vice City Cigars logo small" width="60" height="auto">
      <span>Boca Raton, FL</span>
    </div>
    <div class="footer-legal">
      <span>Â© 2025 Vice City Cigars</span>
      <span class="badge-21">21+ Only</span>
      <span class="no-samples">We do not offer free samples.</span>
      <div class="footer-links">
        <a href="/vccweb/terms">Terms & Conditions</a> | 
        <a href="/vccweb/privacy">Privacy Policy</a> | 
        <a href="/vccweb/shipping">Shipping</a> | 
        <a href="/vccweb/refund">Returns</a>
      </div>
    </div>
    <div class="footer-social">
      <a href="https://instagram.com/vicecitycigars" target="_blank" rel="noopener" aria-label="Instagram">
        <svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="#FF1493" d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
        </svg>
      </a>
    </div>
  </div>
</footer>

  </body>
  </html>
