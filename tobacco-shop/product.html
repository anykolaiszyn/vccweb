---
layout: page
title: "Product Details"
permalink: /tobacco-shop/product/
---

<style>
/* Miami Vice Cyberpunk Theme */
:root {
  --neon-pink: #FF1493;
  --neon-cyan: #00FFFF;
  --gold: #ffcc66;
  --card-bg: rgba(15, 15, 35, 0.8);
  --glass-border: rgba(255, 255, 255, 0.18);
}

.product-detail-container {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 0 1rem;
}

.back-link {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--neon-cyan);
  text-decoration: none;
  margin-bottom: 2rem;
  font-weight: 600;
  transition: all 0.3s ease;
}

.back-link:hover {
  color: var(--neon-pink);
  transform: translateX(-5px);
}

.product-detail-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 3rem;
  margin-bottom: 3rem;
}

/* Image Section */
.product-images {
  background: var(--card-bg);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  padding: 2rem;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

.main-image-container {
  position: relative;
  padding-top: 100%;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 8px;
  overflow: hidden;
  margin-bottom: 1rem;
}

.main-image {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.stock-badge {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: rgba(0, 255, 127, 0.9);
  color: #fff;
  padding: 0.6rem 1.2rem;
  border-radius: 25px;
  font-size: 0.9rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.stock-badge.low-stock {
  background: rgba(255, 165, 0, 0.9);
}

.stock-badge.out-of-stock {
  background: rgba(255, 0, 0, 0.9);
}

/* Product Info Section */
.product-info-section {
  background: var(--card-bg);
  border: 1px solid var(--glass-border);
  border-radius: 12px;
  padding: 2rem;
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

.product-category-badge {
  display: inline-block;
  background: rgba(0, 255, 255, 0.2);
  color: var(--neon-cyan);
  padding: 0.4rem 1rem;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 1rem;
}

.product-title {
  font-family: 'Orbitron', sans-serif;
  font-size: 2rem;
  color: #fff;
  margin: 0 0 1rem 0;
  line-height: 1.3;
}

.product-price-large {
  font-family: 'Orbitron', sans-serif;
  font-size: 2.5rem;
  color: var(--gold);
  font-weight: 700;
  margin: 1.5rem 0;
}

.product-description-full {
  color: #ccc;
  line-height: 1.8;
  font-size: 1.05rem;
  margin: 1.5rem 0;
}

.product-meta {
  display: grid;
  gap: 1rem;
  margin: 2rem 0;
  padding: 1.5rem;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 8px;
}

.meta-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.5rem 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.meta-item:last-child {
  border-bottom: none;
}

.meta-label {
  color: #aaa;
  font-weight: 600;
}

.meta-value {
  color: #fff;
  font-weight: 600;
}

/* Add to Cart Controls */
.add-to-cart-section {
  margin: 2rem 0;
  padding: 1.5rem;
  background: rgba(255, 20, 147, 0.1);
  border: 2px solid var(--neon-pink);
  border-radius: 12px;
}

.quantity-controls {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.quantity-controls label {
  color: #fff;
  font-weight: 600;
  font-size: 1.1rem;
}

.quantity-input-group {
  display: flex;
  align-items: center;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 8px;
  overflow: hidden;
}

.qty-btn {
  background: rgba(255, 255, 255, 0.1);
  border: none;
  color: #fff;
  width: 40px;
  height: 40px;
  font-size: 1.5rem;
  cursor: pointer;
  transition: all 0.2s ease;
}

.qty-btn:hover {
  background: var(--neon-cyan);
  color: #000;
}

.qty-input {
  width: 60px;
  height: 40px;
  border: none;
  background: transparent;
  color: #fff;
  text-align: center;
  font-size: 1.1rem;
  font-weight: 600;
}

.add-to-cart-btn {
  width: 100%;
  background: linear-gradient(135deg, var(--neon-pink), var(--neon-cyan));
  color: #fff;
  border: none;
  padding: 1.2rem;
  border-radius: 8px;
  font-size: 1.2rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: 'Orbitron', sans-serif;
}

.add-to-cart-btn:hover {
  transform: scale(1.02);
  box-shadow: 0 10px 30px rgba(255, 20, 147, 0.5);
}

.add-to-cart-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

/* Legal Notice */
.legal-notice {
  background: rgba(255, 165, 0, 0.1);
  border: 2px solid #ffa500;
  border-radius: 12px;
  padding: 1.5rem;
  margin: 2rem 0;
}

.legal-notice h4 {
  color: #ffa500;
  margin-top: 0;
  font-family: 'Orbitron', sans-serif;
}

.legal-notice ul {
  color: #ccc;
  line-height: 1.8;
  margin: 0;
  padding-left: 1.5rem;
}

/* Toast Notification */
.toast {
  position: fixed;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%) translateY(150%);
  background: linear-gradient(135deg, var(--neon-pink), var(--neon-cyan));
  color: #fff;
  padding: 1rem 2rem;
  border-radius: 50px;
  font-weight: 600;
  box-shadow: 0 10px 30px rgba(255, 20, 147, 0.5);
  z-index: 999998;
  transition: transform 0.3s ease;
}

.toast.show {
  transform: translateX(-50%) translateY(0);
}

/* Loading State */
.loading {
  text-align: center;
  padding: 4rem;
  color: var(--neon-cyan);
  font-size: 1.2rem;
}

.loading::after {
  content: '‚ü≥';
  display: inline-block;
  animation: spin 1s linear infinite;
  margin-left: 0.5rem;
  font-size: 1.5rem;
}

@keyframes spin {
  100% { transform: rotate(360deg); }
}

/* Mobile Responsive */
@media (max-width: 968px) {
  .product-detail-grid {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  
  .product-title {
    font-size: 1.5rem;
  }
  
  .product-price-large {
    font-size: 2rem;
  }
}
</style>

<div class="product-detail-container">
  
  <a href="{{ '/tobacco-shop' | relative_url }}" class="back-link">
    ‚Üê Back to Shop
  </a>
  
  <div id="productContent">
    <div class="loading">Loading product details...</div>
  </div>
  
</div>

<!-- Toast Notification -->
<div id="toast" class="toast"></div>

<script>
(function() {
  'use strict';
  
  const API_URL = 'https://script.google.com/macros/s/AKfycbxV-V5BHN2a97yb0fPYVjuofjJRUAFPnPu1d73kKwnxkqXTojYEFK3c0B1qAOzKO1Aquw/exec';
  let currentProduct = null;
  
  document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const sku = urlParams.get('sku');
    
    if (!sku) {
      showError('No product specified');
      return;
    }
    
    loadProduct(sku);
  });
  
  async function loadProduct(sku) {
    try {
      const response = await fetch(`${API_URL}?route=inventory`);
      const data = await response.json();
      
      if (data.items && Array.isArray(data.items)) {
        const product = data.items.find(item => item.SKU === sku);
        
        if (product) {
          currentProduct = {
            sku: product.SKU || '',
            name: product.Display_Name || 'Unnamed Product',
            price: parseFloat(product.Price) || 0,
            stock: parseInt(product.Qty_On_Hand) || 0,
            description: product.Description || '',
            category: extractCategory(product),
            image: product.Drive_Image_URL || '/assets/img/gallery/cigars.jpg',
            categories: product.Categories || ''
          };
          
          renderProduct();
        } else {
          showError('Product not found');
        }
      } else {
        showError('Failed to load product data');
      }
    } catch (error) {
      console.error('Failed to load product:', error);
      showError('Failed to load product. Please try again.');
    }
  }
  
  function extractCategory(item) {
    if (item.Category_Level_2) return item.Category_Level_2;
    if (item.Lowest_Category) return item.Lowest_Category;
    
    if (item.Categories) {
      const parts = item.Categories.split('>').map(s => s.trim());
      return parts[parts.length - 1] || 'Uncategorized';
    }
    
    return 'Uncategorized';
  }
  
  function renderProduct() {
    const stockStatus = getStockStatus(currentProduct.stock);
    
    const html = `
      <div class="product-detail-grid">
        
        <!-- Image Section -->
        <div class="product-images">
          <div class="main-image-container">
            <img src="${escapeHTML(currentProduct.image)}" alt="${escapeHTML(currentProduct.name)}" class="main-image">
            <span class="stock-badge ${stockStatus.class}">${stockStatus.text}</span>
          </div>
        </div>
        
        <!-- Info Section -->
        <div class="product-info-section">
          
          <span class="product-category-badge">${escapeHTML(currentProduct.category)}</span>
          
          <h1 class="product-title">${escapeHTML(currentProduct.name)}</h1>
          
          <div class="product-price-large">$${currentProduct.price.toFixed(2)}</div>
          
          <div class="product-description-full">${currentProduct.description}</div>
          
          <div class="product-meta">
            <div class="meta-item">
              <span class="meta-label">SKU:</span>
              <span class="meta-value">${escapeHTML(currentProduct.sku)}</span>
            </div>
            <div class="meta-item">
              <span class="meta-label">Category:</span>
              <span class="meta-value">${escapeHTML(currentProduct.category)}</span>
            </div>
            <div class="meta-item">
              <span class="meta-label">Availability:</span>
              <span class="meta-value">${stockStatus.text}</span>
            </div>
          </div>
          
          ${currentProduct.stock > 0 ? `
          <div class="add-to-cart-section">
            <div class="quantity-controls">
              <label for="quantity">Quantity:</label>
              <div class="quantity-input-group">
                <button class="qty-btn" onclick="adjustQuantity(-1)">‚àí</button>
                <input type="number" id="quantity" class="qty-input" value="1" min="1" max="${currentProduct.stock}">
                <button class="qty-btn" onclick="adjustQuantity(1)">+</button>
              </div>
            </div>
            <button class="add-to-cart-btn" onclick="addToCart()">
              üõí Add to Cart
            </button>
          </div>
          ` : '<div class="add-to-cart-section"><p style="text-align: center; color: #ff6b6b; font-weight: 600;">Currently Out of Stock</p></div>'}
          
          <div class="legal-notice">
            <h4>‚ö†Ô∏è Important Legal Information</h4>
            <ul>
              <li><strong>Age Restriction:</strong> Must be 21+ to purchase tobacco products</li>
              <li><strong>ID Verification:</strong> Valid government-issued photo ID required at checkout</li>
              <li><strong>Adult Signature:</strong> Required upon delivery ($8.50 fee applies)</li>
              <li><strong>Restrictions:</strong> Sales where allowed by law only</li>
              <li><strong>Privacy:</strong> ID photos deleted within 24 hours of verification</li>
            </ul>
          </div>
          
        </div>
        
      </div>
    `;
    
    document.getElementById('productContent').innerHTML = html;
  }
  
  function getStockStatus(stock) {
    if (stock === 0) {
      return { class: 'out-of-stock', text: 'Out of Stock' };
    } else if (stock <= 5) {
      return { class: 'low-stock', text: `Only ${stock} Left` };
    } else {
      return { class: 'in-stock', text: 'In Stock' };
    }
  }
  
  window.adjustQuantity = function(delta) {
    const input = document.getElementById('quantity');
    const current = parseInt(input.value) || 1;
    const newValue = Math.max(1, Math.min(currentProduct.stock, current + delta));
    input.value = newValue;
  };
  
  window.addToCart = function() {
    const quantity = parseInt(document.getElementById('quantity').value) || 1;
    
    if (quantity > currentProduct.stock) {
      showToast('Quantity exceeds available stock');
      return;
    }
    
    // Get existing cart
    let cart = getCart();
    
    // Check if product already in cart
    const existingIndex = cart.findIndex(item => item.sku === currentProduct.sku);
    
    if (existingIndex >= 0) {
      // Update quantity
      cart[existingIndex].quantity += quantity;
    } else {
      // Add new item
      cart.push({
        sku: currentProduct.sku,
        name: currentProduct.name,
        price: currentProduct.price,
        quantity: quantity,
        image: currentProduct.image
      });
    }
    
    // Save cart with 24hr expiry
    saveCart(cart);
    
    showToast(`Added ${quantity} √ó ${currentProduct.name} to cart`);
    
    // Redirect to cart after 1.5 seconds
    setTimeout(() => {
      window.location.href = `{{ '/tobacco-shop/cart' | relative_url }}`;
    }, 1500);
  };
  
  function getCart() {
    try {
      const cart = localStorage.getItem('vcc_tobacco_cart');
      if (!cart) return [];
      
      const parsed = JSON.parse(cart);
      
      // Check expiry
      if (parsed.expiry && Date.now() > parsed.expiry) {
        localStorage.removeItem('vcc_tobacco_cart');
        return [];
      }
      
      return parsed.items || [];
    } catch (e) {
      return [];
    }
  }
  
  function saveCart(items) {
    const data = {
      items: items,
      expiry: Date.now() + (24 * 60 * 60 * 1000) // 24 hours
    };
    localStorage.setItem('vcc_tobacco_cart', JSON.stringify(data));
  }
  
  function showToast(message) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.classList.add('show');
    
    setTimeout(() => {
      toast.classList.remove('show');
    }, 2500);
  }
  
  function showError(message) {
    document.getElementById('productContent').innerHTML = `
      <div style="text-align: center; padding: 4rem; color: #ff6b6b;">
        <h2>‚ö†Ô∏è ${escapeHTML(message)}</h2>
        <p><a href="{{ '/tobacco-shop' | relative_url }}" style="color: var(--neon-cyan);">Return to shop</a></p>
      </div>
    `;
  }
  
  function escapeHTML(str) {
    const div = document.createElement('div');
    div.textContent = str;
    return div.innerHTML;
  }
  
})();
</script>
